


<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1, mkdocs-material-5.1.0">
    
    
      
        <title>Job Submission - Snowmass21 Connect</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.89dc9fe3.min.css">
      
      
    
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    <body dir="ltr">
  
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#job-submission" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href=".." title="Snowmass21 Connect" class="md-header-nav__button md-logo" aria-label="Snowmass21 Connect">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12,8A3,3 0 0,0 15,5A3,3 0 0,0 12,2A3,3 0 0,0 9,5A3,3 0 0,0 12,8M12,11.54C9.64,9.35 6.5,8 3,8V19C6.5,19 9.64,20.35 12,22.54C14.36,20.35 17.5,19 21,19V8C17.5,8 14.36,9.35 12,11.54Z" /></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3,6H21V8H3V6M3,11H21V13H3V11M3,16H21V18H3V16Z" /></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            Snowmass21 Connect
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              Job Submission
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z" /></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z" /></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z" /></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
        
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Snowmass21 Connect" class="md-nav__button md-logo" aria-label="Snowmass21 Connect">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12,8A3,3 0 0,0 15,5A3,3 0 0,0 12,2A3,3 0 0,0 9,5A3,3 0 0,0 12,8M12,11.54C9.64,9.35 6.5,8 3,8V19C6.5,19 9.64,20.35 12,22.54C14.36,20.35 17.5,19 21,19V8C17.5,8 14.36,9.35 12,11.54Z" /></svg>

    </a>
    Snowmass21 Connect
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../accounting/" title="Getting Started" class="md-nav__link">
      Getting Started
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../data_management_main/" title="Data Management" class="md-nav__link">
      Data Management
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Job Submission
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3,9H17V7H3V9M3,13H17V11H3V13M3,17H17V15H3V17M19,17H21V15H19V17M19,7V9H21V7H19M19,13H21V11H19V13Z" /></svg>
        </span>
      </label>
    
    <a href="./" title="Job Submission" class="md-nav__link md-nav__link--active">
      Job Submission
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#job-submission-guidelines" class="md-nav__link">
    Job Submission Guidelines
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-tutorial-command" class="md-nav__link">
    The Tutorial Command
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#list-of-options-for-the-tutorial-command" class="md-nav__link">
    List of options for the tutorial command
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#available-tutorials" class="md-nav__link">
    Available Tutorials
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#install-and-setup-a-tutorial" class="md-nav__link">
    Install and Setup a Tutorial
  </a>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../software/" title="Software Access" class="md-nav__link">
      Software Access
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#job-submission-guidelines" class="md-nav__link">
    Job Submission Guidelines
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-tutorial-command" class="md-nav__link">
    The Tutorial Command
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#list-of-options-for-the-tutorial-command" class="md-nav__link">
    List of options for the tutorial command
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#available-tutorials" class="md-nav__link">
    Available Tutorials
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#install-and-setup-a-tutorial" class="md-nav__link">
    Install and Setup a Tutorial
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  
                
                
                <h1 id="job-submission">Job Submission</h1>
<p>This section provides a short introduction on how to submit jobs to the OSG from the Snowmass Connect login node using the snowmass21.energy subgroup 
as the project name. A minimal HTCondor submission script, <code>myjob.submit</code>, to the OSG is inlined below:</p>
<pre><code>Universe = Vanilla
Executable     = run.sh
Error   = output.err.$(Cluster)-$(Process)
Output  = output.out.$(Cluster)-$(Process)
Log     = output.log.$(Cluster)
should_transfer_files = YES
WhenToTransferOutput = ON_EXIT
request_cpus = 1
request_memory = 1 GB
+ProjectName="snowmass21.energy"
Queue 1
</code></pre>
<p>Refer to the <a href="https://htcondor.readthedocs.io/en/stable/users-manual/index.html">HTCondor manual</a> or the <a href="https://support.opensciencegrid.org/support/home">OSG Helpdesk</a> for more information on the declared parameters and on customizing your submission scripts.</p>
<p>When the HTCondor script above is submitted, you request a remote worker node with 1 core and 1 GB to run the <code>run.sh</code> executable. In this case, <code>run.sh</code> is a shell script that contains a list of commands that executes your workload on the worker node.  For example: </p>
<pre><code>#/bin/bash
./code_executable &lt;input_file&gt; &lt;output_file&gt;
&lt;additional commands&gt;
</code></pre>
<p>The parameter <code>should_transfer_files = YES</code> instructs HTCondor to use the HTCondor file transfer 
method to transfer the <code>Executable</code> to the remote host and the job files <code>Error</code> (stderr) , <code>Output</code> (stdout) and <code>Log</code> 
back to your directory on the submit host. You will have a number of options to transfer code executables and input/output files to the remote worker node, described in the next section.</p>
<p>You can submit the job script to the OSG via the HTCondor command on the Snowmass login node as: 
<code>condor_submit myjob.submit</code>, which will return a unique <code>&lt;JobID&gt;</code> number. 
You can use the <code>&lt;JobID&gt;</code> to query the status of your job with <code>condor_q &lt;JobID&gt;</code></p>
<p>For an introduction on managing your jobs with HTCondor we refer to <a href="https://opensciencegrid.org/user-school-2019/#materials/day1/files/osgus19-day1-part1-intro-to-htc.pdf">this</a> presentation by the OSG.</p>
<h3 id="job-submission-guidelines">Job Submission Guidelines</h3>
<ol>
<li>
<p>If your application/code was built or depends on modules used on the snowmass21 login node and it dynamically links against libraries of the module environment you would need to ensure that these modules are also availablle and loaded on the remote worker node. To do so:</p>
<ul>
<li>Insert the following parameter in your submission script: <code>Requirements = (HAS_MODULES =?= TRUE)</code>. This will request a worker node on a site where the OSG modules are available</li>
<li>Before you invoke your executable inside the <code>run.sh</code> script load the modules as: <code>module load module1 module2</code></li>
</ul>
</li>
<li>
<p>You must always populate the project name field, e.g. <code>+ProjectName="snowmass21.energy"</code>, in your HTCondor submission script to:</p>
<ul>
<li>Ensure your job is validated for HTCondor to run it on the OSG grid</li>
<li>Job statistics are properly collected and displayed on the <a href="https://bit.ly/3j36bAc">OSG monitoring dashboard</a> for the snowmass project.</li>
</ul>
</li>
</ol>
<h2 id="the-tutorial-command">The Tutorial Command</h2>
<p>OSG provides a list of tutorials available as repositories on Github. These tutorials are designed for OSG submit nodes, are tested regularly and should work as is, but if you experience any issues please contact us. Users on the Snowmass login node should be able to run most of those. </p>
<h2 id="list-of-options-for-the-tutorial-command">List of options for the tutorial command</h2>
<p>From the Snowmass21 Connect login node, the following tutorial commands are available:</p>
<pre><code>$ tutorial
$ tutorial list
$ tutorial info &lt;tutorial-name&gt;
$ tutorial &lt;tutorial-name&gt;
</code></pre>
<h2 id="available-tutorials">Available Tutorials</h2>
<p>The following tutorials pre-installed. Some additional tutorials specific to Snowmass21 will be deployed there as well. Tutorials that will not work on the Snowmass login node at present are struckthrough. To see what is currently available: </p>
<pre><code>$ tutorial list
Currently available tutorials:
R ...................... Estimate Pi using the R programming language
R-addlibSNA ............ Shows how to add R external libraries for the R jobs on the OSG
ScalingUp-Python ....... Scaling up compute resources - Python example to optimize a function on grid points
annex .................. None
blast-split ............ How to run BLAST on the OSG by splitting a large input file
connect-client ......... Demonstrates how to use the connect client for remote job submission
dagman-wordfreq ........ DAGMan based wordfreq example
dagman-wordfreq-stash .. DAGMan based wordfreq - data from stash
error101 ............... Use condor_q -better-analyze to analyze stuck jobs
exitcode ............... Use HTCondor's periodic_release to retry failed jobs
htcondor-transfer ...... Transfer data via HTCondor's own mechanisms
matlab-HelloWorld ...... Creating standalone MATLAB application - Hello World 
nelle-nemo ............. Running Nelle Nemo's goostats on the grid
oasis-parrot ........... Software access with OASIS and Parrot
octave ................. Matrix manipulation via the Octave programming language
osg-locations .......... Tutorial based on OSG location exercise from the User School
pegasus ................ An introduction to the Pegasus job workflow manager
photodemo .............. A complete analysis workflow using HTTP transfer
quickstart ............. How to run your first OSG job
root ................... Inspect ntuples using the ROOT analysis framework
scaling ................ Learn to steer jobs to particular resources
scaling-up-resources ... A simple multi-job demonstration
software ............... Software access tutorial
tensorflow-matmul ...... Tensorflow math operations as a singularity container job on the OSG - matrix multiplication
</code></pre>
<p>Tutorials <code>stash-cvmfs</code> and <code>stash-http</code> do not work on the Snowmass Connect Login node at present. We are working to replace with working variants.</p>
<h2 id="install-and-setup-a-tutorial">Install and Setup a Tutorial</h2>
<p>On the Snowmass Connect login node, create a directory, cd to it, and invoke the command:</p>
<pre><code>$ tutorial &lt;tutorial-name&gt;
</code></pre>
<p>This command will clone the tutorial repository to your current working directory. cd to the repository directory 
and follow the steps described in the readme.md file. Alternatively, you can view the readme.md 
file at the tutorial's corresponding GitHub page.</p>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../data_management_main/" title="Data Management" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Data Management
              </div>
            </div>
          </a>
        
        
          <a href="../software/" title="Software Access" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Software Access
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4,11V13H16L10.5,18.5L11.92,19.92L19.84,12L11.92,4.08L10.5,5.5L16,11H4Z" /></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/vendor.36cbf620.min.js"></script>
      <script src="../assets/javascripts/bundle.00c583dd.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script>
      
      <script>
        app = initialize({
          base: "..",
          features: ["instant"],
          search: Object.assign({
            worker: "../assets/javascripts/worker/search.7f7c8775.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
    
  </body>
</html>